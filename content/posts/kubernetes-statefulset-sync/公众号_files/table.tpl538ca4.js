define("pages/modules/media_dialog/link_dialog/link_dialog.tpl.js",[],function(l,i,e){return'<mp-dialog ref="linkDialog" weui="true" v-model="dialogShow" :value="true" :title="title" :width="960" class="weui-desktop-link-dialog" @close="onDialogClose" rootElm="#vue_app">  <mp-tab    :tabs="tabs"    :selected="selectedTab"    @click="changeTab"    v-if="tabs.length > 1"  ></mp-tab>  <div class="link_dialog_panel">      <mp-inner-link        ref="innerLink"        v-show="selectedTab === \'innerlink\'"        :nickname="nickname"        :link-title="linkinfo.title"        :link-url="linkUrl"></mp-inner-link>      <mp-outer-link        ref="outerLink"        v-show="selectedTab === \'outerlink\'"        :link-title="linkinfo.title"        :link-url="linkUrl"></mp-outer-link>  </div>  <template slot="footer">    <button class="weui-desktop-btn weui-desktop-btn_primary" @click="onDialogOK">完成</button>  </template></mp-dialog>'})
define("pages/editor/videoDialog4Web1.js",["pages/modules/media_dialog/video_dialog/video_dialog.js"],function(e,o,i){"use strict"
function d(){return{msgtype:0,canusetxvideo:!0,canuselink:!0,tabselected:"library",scene:"default",showsharedialog:!1,isShow:!1,defaultShow:!1,allowChooseLength:1,videoList:[]}}function a(e,o){var i=d()
for(var a in o)void 0!==i[a]&&(i[a]=o[a])
for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e.params[t]=i[t])
e.params.isShow=!0,e.params.defaultShow=!0}i.exports={getParams:d,bindEvent:function(o){o.eventBus.$on("requireVideoDialog",function(){o.isRequired||(e("pages/modules/media_dialog/video_dialog/video_dialog.js"),o.isRequired=!0)}),o.eventBus.$on("showVideoDialog",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}
o.eventBus.$emit("requireVideoDialog"),a(o,e),o.eventBus.$emit("update-component",{key:"mp-video-dialog",params:o.params})}),o.eventBus.$on("hideVideoDialog",function(e){o.params.isShow=!e}),o.eventBus.$on("showRelatedVideoDialog",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}
o.eventBus.$emit("requireVideoDialog"),a(o,e),o.eventBus.$emit("update-component",{key:"mp-video-dialog",params:o.params})})},close:function(e){e.data&&(e.data.isMyMpVideo=!("library"!==e.tab||!e.data.is_mp_video)),e.scene&&"morevideo"===e.scene?e.eventBus.$emit("showRelatedVideoDialog_callback",e.data):e.eventBus.$emit("showVideoDialog_callback",e.data,e.tab)}}})
define("pages/modules/media_dialog/video_dialog/video_dialog.js",["vue-weui/src/pagination/pagination.js","vue-weui/src/tab/tab.js","vue-weui/src/dialog/dialog.js","pages/modules/media_dialog/video_dialog/video_dialog.css.js","vue-weui/src/checkbox/checkbox.js","vue-weui/src/input/input.js","pages/modules/utils/loadscript.js","pages/modules/media_dialog/video_dialog/video_dialog.tpl.js","pages/modules/utils/cgi.js","pages/modules/utils/time.js","pages/media/modules/video_status/video_status.js","pages/media/modules/common/getVinfo.js","pages/modules/utils/str_util.js","pages/modules/utils/url.js"],function(t,e,i){"use strict"
var d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]
for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}
t("vue-weui/src/pagination/pagination.js"),t("vue-weui/src/tab/tab.js"),t("vue-weui/src/dialog/dialog.js"),t("pages/modules/media_dialog/video_dialog/video_dialog.css.js"),t("vue-weui/src/checkbox/checkbox.js"),t("vue-weui/src/input/input.js")
var u=t("pages/modules/utils/loadscript.js").load,n=t("pages/modules/media_dialog/video_dialog/video_dialog.tpl.js"),r=t("pages/modules/utils/cgi.js"),s=t("pages/modules/utils/time.js"),h=t("pages/media/modules/video_status/video_status.js"),l=t("pages/media/modules/common/getVinfo.js"),c=t("pages/modules/utils/str_util.js"),o=t("pages/modules/utils/url.js"),g=window.BJ_REPORT
function a(t,e){if(!t)return 0;(t=t.cloneNode(!0)).style.visibility="hidden",document.body.appendChild(t)
var i=0,n=t.offsetHeight
e?i+=parseInt(window.getComputedStyle(t).marginTop,10)+parseInt(window.getComputedStyle(t).marginBottom,10)+n:i+=n
return document.body.removeChild(t),t.style.visibility="visible",i}function f(t,e,i){var n=1<arguments.length&&void 0!==e?e:"default",s=2<arguments.length&&void 0!==i?i:1,o=!1
switch(n){case"ueditor":case"masssend":o=!0
break
case"morevideo":o=!1
break
case"default":default:o=!0}return{loading:!1,list:[],totalCount:0,pageLen:10,selectedData:"morevideo"===n?t:[],showUpload:o,allowChooseLength:s,currentPage:1,showSelected:!1}}function p(t){return{loading:!1,list:[],totalCount:0,pageLen:10,selectedData:[],allowChooseLength:t,currentPage:1,inputLink:"",showLinkInfo:!1,showSelected:!1,linkInputStatus:"normal"}}Vue.component("mp-video-dialog",{template:n,props:{videoList:{type:Array,default:function(){return[]}},msgtype:{type:Number},value:{type:Boolean,default:!1},canusetxvideo:{type:Boolean,default:!0},canuselink:{type:Boolean,default:!1},tabselected:{type:String,default:"library",validator:function(t){return-1<["library","link"].indexOf(t)}},scene:{type:String,default:"ueditor",validator:function(t){return-1<["ueditor","masssend","morevideo","default"].indexOf(t)}},showsharedialog:{type:Boolean,default:!1},allowChooseLength:{type:Number,default:1}},data:function(){var t,e,i,n=this.videoList||[],s=function(t){return"morevideo"===(0<arguments.length&&void 0!==t?t:"default")?"从全量群发的视频消息中选择":"选择视频"}(this.scene)
return{tabs:(t=this.canusetxvideo,e=this.canuselink,i=[],t&&i.push({id:"library",name:"素材库",url:"",show:!0}),e&&i.push({id:"link",name:"视频链接",url:"",show:!0}),i),tab:this.canusetxvideo&&"library"===this.tabselected?"library":"link",searchData:"",searchKey:"",dialogShow:!1,conf:{library:f(n,this.scene,this.allowChooseLength),link:p(this.allowChooseLength)},hoverItem:null,itemHeight:114,dialogHeight:0,lastHeight:0,height:0,linkHeight:0,oriLibHeight:0,dialogTitle:s,loadingHeight:0}},created:function(){this.searchInfo={begin:0,cnt:0,count:0,list:[]}},mounted:function(){!0===this.value&&this.show()
var t=this.$refs.videoDialog,e=t&&t.$refs.main,i=e&&e.querySelector(".weui-desktop-dialog")
this.dialogHeight=a(i)
var n=this.$refs.libPanel
this.oriLibHeight=a(n,!0)
var s=this
window.addEventListener("resize",function(){s.timer&&clearTimeout(s.timer),s.timer=setTimeout(function(){s.needResize()&&"library"===s.tab&&s.getVideoData(s.conf.library.currentPage).then(function(t){s.pageChangeSucCb(t)}).catch(function(t){console.log(t),s.pageChangeErrCb()})},250)})},methods:{initData:function(){this.conf={library:f(this.videoList,this.scene,this.allowChooseLength),link:p(this.allowChooseLength)},this.hoverItem=null,this.tab="library"},closeDialog:function(){this.hide(),this.$emit("cancel")},show:function(){!1===this.dialogShow&&(this.dialogShow=!0)},hide:function(){!0===this.dialogShow&&(this.dialogShow=!1)},uploadVideo:function(){window.openUrl("/cgi-bin/appmsg?t=media/videomsg_edit&action=video_edit&type=15",{},!0)},onSearch:function(t){var e=this
this.conf[this.tab].showSelected&&this.changeViewToAllVideo(),"string"==typeof t?(this.searchInfo={begin:0,cnt:0,count:0,list:[]},this.searchKey=t):this.searchKey="",this.conf[this.tab].currentPage=1,this.getVideoData(1).then(function(t){e.pageChangeSucCb(t)}).catch(function(t){console.log(t),e.pageChangeErrCb()})},tabChange:function(t){var e=this
if("library"===t)this.needResize()&&this.getVideoData(this.conf.library.currentPage).then(function(t){e.pageChangeSucCb(t)}).catch(function(t){console.log(t),e.pageChangeErrCb()})
else if("link"===t){var i=this.$refs.libPanel.offsetHeight-100
this.linkHeight=i+"px"}this.tab=t},needResize:function(){var t=!1,e=window.innerHeight-this.dialogHeight-80,i=Math.floor(e/this.itemHeight)
i=i<3?3:i,e/this.itemHeight-i!=0&&(e=this.itemHeight*i),e!==this.lastHeight&&(t=!0),this.conf.library.pageLen=2*i,this.lastHeight=e,this.height=e+"px"
var n=e+24.5
if(this.loadingHeight=n+"px",0!==this.oriLibHeight){var s=this.oriLibHeight+e-100
this.linkHeight=s+"px"}if(this.searchKey)this.searchInfo.len=Math.ceil(this.searchInfo.count/this.conf.library.pageLen)
else if(0<this.conf[this.tab].totalCount){var o=Math.ceil(this.conf[this.tab].totalCount/this.conf[this.tab].pageLen)
this.conf[this.tab].currentPage>o&&(this.conf[this.tab].currentPage=o)}return t},getVideoData:function(n){var s=this
this.conf.library.loading=!0
var t=void 0
"ueditor"!==this.scene&&"morevideo"===this.scene?(t="/cgi-bin/appmsg?action=list_pub_video&count="+this.conf.library.pageLen,this.searchKey?(n>this.searchInfo.len&&(this.conf[this.tab].currentPage=this.searchInfo.len,n=this.searchInfo.len),t+="&begin="+this.searchInfo.begin+"&query="+this.searchKey):t+="&begin="+this.conf.library.pageLen*(n-1)):(t="&type=15&begin="+this.conf.library.pageLen*(n-1)+"&f=json",t="/cgi-bin/appmsg?action=list&count="+this.conf.library.pageLen+t)
function o(t){s.conf.library.loading=!1,t({app_msg_cnt:a.count,app_msg_list:a.list.slice((n-1)*s.conf.library.pageLen,n*s.conf.library.pageLen)})}var a=this.searchInfo
return this.searchKey&&(a.list.length>=n*this.conf.library.pageLen||a.begin>a.cnt)?new Promise(o):new Promise(function(e,i){r.get({url:t},function(t){t&&t.base_resp&&0===t.base_resp.ret?s.searchKey?(0===a.begin&&(a.count=t.app_msg_cnt,a.cnt=t.app_msg_cnt,a.len=Math.ceil(t.app_msg_cnt/s.conf.library.pageLen)),a.begin+=s.conf.library.pageLen,a.list=a.list.concat(t.app_msg_list),a.begin<=a.cnt?a.count-=s.conf.library.pageLen-t.app_msg_list.length:(0===t.app_msg_list.length&&(s.conf[s.tab].currentPage--,n--),a.count=a.list.length),a.begin>=a.cnt||a.list.length>=n*s.conf.library.pageLen?o(e):s.getVideoData(n).then(e).catch(i)):(s.conf.library.loading=!1,e(t)):(s.conf.library.loading=!1,i(t))})})},pageChange:function(t){var e=this,i=t.currentPage
this.conf[this.tab].currentPage=i,this.getVideoData(i).then(function(t){e.pageChangeSucCb(t)}).catch(function(t){console.log(t),e.pageChangeErrCb()})},xssFilter:function(t){return"string"==typeof t.title?t.title.replace(/<|>/gi,function(t){return{"<":"&#60;",">":"&#62;"}[t]}):t.title},pageChangeSucCb:function(t){var e=this,i=void 0,n=this.conf[this.tab].selectedData
if("morevideo"===this.scene)this.conf.library.totalCount=t.app_msg_cnt,i=(i=t.app_msg_list).map(function(t){return t.status=t.video_status,t.canSelect=!0,t})
else{i=t.app_msg_info.file_item||t.app_msg_info.item,Array.isArray(i)&&(i=(i=i.map(function(t){return d({},t,t.multi_item?t.multi_item[0]:{})})).map(function(t){return t.update_time=t.create_time,t.video_id=t.content,t.vid=t.content,t.play_length=e.durationStr2Sec(t.duration),t.is_mp_video*=1,t.aid=t.content,t.url=e.getPlayurlByVid(t.vid,t.is_mp_video),t})),this.conf.library.totalCount=t.app_msg_info.file_cnt.video_msg_cnt||t.app_msg_info.file_cnt.video_cnt
for(var s=0;s<i.length;s++){var o=i[s],a=h.getVideoStatus(o)
switch(o.statusId=a,o.canSelect=!0,a){case 0:o.statusMsg="审核中"
break
case 10:o.statusMsg="修改审核中"
break
case 11:o.statusMsg="已下架",o.statusInfo="因源视频被删除，该视频无法被选择，请重新上传"
break
case 12:o.statusMsg="已下架",o.statusInfo="因源视频被取消原创，该视频无法被选择，请重新上传"
break
case 1:o.statusMsg="资料不完整"
break
case 2:o.statusMsg="审核不通过",o.statusInfo="该视频审核不通过，无法被选择"
break
case 8:o.statusMsg="修改审核失败"
break
case 6:o.statusMsg="原创声明失败"
break
case 7:o.statusMsg="原创校验失败"
break
case 4:o.statusMsg="转码中"
break
case 9:o.statusMsg="已下架"
break
case 5:o.statusMsg="转码失败",o.statusInfo="该视频转码失败，无法被选择，请前往素材库重新上传"
break
default:o.statusMsg=""}var r=h.canModify(o)
1!=+o.is_new_video||r?1==+o.is_new_video||o.content_url||(o.statusInfo=o.statusInfo?o.statusInfo:"转码完成后才可使用",o.canSelect=!1):(o.statusInfo=o.statusInfo?o.statusInfo:"该视频目前无法被选择",o.canSelect=!1),5!==this.msgtype&&0!==this.msgtype||0!==a&&4!==a&&10!==a||(o.canSelect=!0,o.statusInfo=""),1===o.video_ori_status&&o.is_new_video&&3===o.status?o.tag="原创":2===o.video_ori_status&&o.is_new_video&&3===o.status&&(o.tag="转载"),console.log(o.video_ori_status,o.is_new_video,o.status,o.tag)}}i.forEach(function(t){t.duration=e.formatDuration(t.duration),e.$set(t,"checked",!1)}),n.forEach(function(t){e.$set(t,"checked",!0)})
for(var l=0;l<n.length;l++)for(var c=0;c<i.length;c++)n[l].aid===i[c].aid&&(i[c].checked=!0)
i.forEach(function(t){t.title=e.xssFilter(t)}),this.conf.library.list=i},pageChangeErrCb:function(){this.$tipsErr("系统错误，请稍后重试")},searchVideo:function(){this.conf.link.linkInputStatus="normal",this.conf.link.showLinkInfo=!1
var r=this.conf.link.inputLink
if(""!==r.length){if(!(0<=this.getLinkType(r)))return this.conf.link.loading=!1,this.conf.link.showLinkInfo=!1,void(this.conf.link.linkInputStatus="warn")
this.conf.link.linkInputStatus="normal",this.conf.link.loading=!0
var l=this
this.convert_url(r,function(t){if(r===l.conf.link.inputLink){if(!t||!t.vidInfo||0===t.vidInfo.length)return l.conf.link.showLinkInfo=!0,void(l.conf.link.loading=!1)
for(var e=t.vidInfo,i={return_count:0,video_info:[],total:e.length},n=0;n<e.length;n++){var s={title:"",cover:"",duration:"",is_new_video:1,video_ori_status:4,status:3,source:"file"},o=e[n],a=o.vid
console.log("fuck",o),1==+o.is_mp_video?(2==+o.status?(s.statusMsg="审核失败",s.statusInfo="该视频审核不通过，无法被选择"):9==+o.status?(s.statusMsg="已下架",s.statusInfo="该视频已下架，无法被选择"):0==+o.status?(s.statusMsg="审核中",s.statusInfo="该视频在审核中，审核通过后才能选择"):10==+o.status?(s.statusMsg="已被发布者删除",s.statusInfo="该视频已被发布者删除"):3===o.status&&1===o.video_reprint_status?(s.statusMsg="已下架",s.statusInfo="因源视频被删除，该视频无法被选择，请重新上传"):3===o.status&&2===o.video_reprint_status&&(s.statusMsg="已下架",s.statusInfo="因源视频被取消原创，该视频无法被选择，请重新上传"),l.getMpVideoInfoByVid(a,i,s,r,o)):l.getTxVideoInfoByVid(a,i,s,r,o)}}},null,function(){r===l.videoLink&&(l.linkLoading=!1,l.linkInputStatus="warn",l.$tipsErr("该网址存在错误，请填写正确的腾讯视频网址"))})}},getMpVideoInfoByVid:function(i,n,s,o,a){var r=this
l.getMpVideoInfo({vid:i,onSuccess:function(t){if(o===r.conf.link.inputLink){n.return_count++
var e=JSON.parse(JSON.stringify(s))
e.id=n.return_count,e.title=t.data.title,e.play_length=t.data.time||0,e.duration=parseInt(t.data.time||0,10),e.cover=t.data.cover,e.video_id=i,e.is_mp_video=1,e.ori_status=a.ori_status,e.hit_nickname=a.hit_nickname,e.aid=e.video_id,e.statusMsg=s.statusMsg||t.err_msg,e.statusInfo=e.statusMsg&&""!==e.statusMsg?e.statusInfo||"该视频无法被选择":"",e.checked=r.isVideoChecked(e),e.canSelect=""===e.statusMsg,1===e.ori_status&&3===a.status?e.tag="原创":2===e.ori_status&&3===a.status&&(e.tag="转载",0===a.is_in_white_list&&(e.showOriTips=1)),console.log(e.ori_status,a.status,e.tag,e.showOriTips),n.video_info.push(e),n.return_count===n.total&&(r.conf.link.list=n.video_info,r.conf.link.loading=!1,r.conf.link.showLinkInfo=!0,1===n.total&&(r.isVideoChecked(n.video_info[0])||r.selectVideo(n.video_info[0])))}},onError:function(){o===r.conf.link.inputLink&&(n.return_count++,n.return_count===n.total&&0===n.video_info.length&&(r.$tipsErr("获取视频失败，请重试"),r.conf.link.loading=!1))}})},getTxVideoInfoByVid:function(i,n,s,o){var a=this
l.getInfoByVid({vid:i,onSuccess:function(t){if(o===a.conf.link.inputLink){n.return_count++
var e=JSON.parse(JSON.stringify(s))
e.id=n.return_count,e.title=t.data.title,e.play_length=t.data.time||0,e.duration=parseInt(t.data.time||0,10),e.cover=t.data.p16_9,e.video_id=i,e.is_mp_video=0,e.aid=e.video_id,e.statusMsg=t.errMsg,e.checked=a.isVideoChecked(e),e.canSelect=""===e.statusMsg,n.video_info.push(e),80==+t.retCode&&1==+t.oriData.exem&&(n.video_info[n.video_info.length-1].err_msg="",n.video_info[n.video_info.length-1].statusMsg="",n.video_info[n.video_info.length-1].canSelect=!0),e.statusInfo=e.statusMsg&&""!==e.statusMsg?e.statusInfo||"该视频无法被选择":"",n.return_count===n.total&&(a.conf.link.list=n.video_info,a.conf.link.loading=!1,a.conf.link.showLinkInfo=!0,1===n.total&&(a.isVideoChecked(n.video_info[0])||a.selectVideo(n.video_info[0])))}},onError:function(){o===a.conf.link.inputLink&&(n.return_count++,n.return_count===n.total&&1===a.conf.link.allowChooseLength&&(a.$tipsErr("获取视频失败，请重试"),a.conf.link.loading=!1))}})},getLinkType:function(t){return t=t.replace(/^\s+|\s+$/g,"").replace("http://","").replace("https://",""),/^(v|cache.tv|m.v)\.qq\.com([\/?].*)*$/i.test(t)?0:/^mp\.weixin\.qq\.com\/video\?.*$/i.test(t)?1:/^mp\.weixin\.qq\.com\/s[\?\/].+$/i.test(t)?2:/^mp\.weixin\.qq\.com\/mp\/readtemplate\?t=pages\/video_player_tmpl.*$/i.test(t)?3:-1},convert_url:function(t,e,i,n){var s=this.getLinkType(t)
i=i||{},0===s?this.handleTencentVideo(t,e,i,n):2===s?this.handleAppmsgUrl(t,e):1===s?this.handleVideoDetailUrl(t,e):3===s&&this.handleMpPlayerUrl(t,e)},handleTencentVideo:function(i,n,t,e){var s="",o=null,a=i.match(new RegExp("(^|&|\\\\?)vid=([^&]+)(&|$|#)")),r=i.match(new RegExp("(^|&|\\\\?)cid=([^&]+)(&|$|#)")),l=i.match(new RegExp("(http://)?(cache.tv|m.v|v)\\.qq\\.com/cover[^/]*/\\w+/([^/]*)\\.html")),c=i.match(new RegExp("(http://)?(cache.tv|m.v|v)\\.qq\\.com/prev[^/]*/\\w+/([^/]*)\\.html")),d=i.match(/\/(\w{15})\.html/)
if(a)o=a,-1!==(s=encodeURIComponent(o[2])).indexOf("_")&&(s=s.split("_")[0]),!/[a-zA-Z0-9]{11}/.test(s)&&g&&g.monitor&&g.monitor(94,"vid:"+s+";url="+i,39),n({vidInfo:[{vid:s,is_mp_video:0}]})
else if(r||l||c||d){var h=null
h=3<=(o=r||l||c||d).length?encodeURIComponent(o[2]):encodeURIComponent(o[1]),u({url:"https://data.video.qq.com/fcgi-bin/data?tid=554&appid=20001184&appkey=85a707e3a07cc44d&callback=QZOutputJson&otype=json&idlist="+h,timeout:1e4,callbackName:"QZOutputJson",callback:function(t){var e=0<arguments.length&&void 0!==t?t:{}
try{-1!==(s=e.results[0].fields.video_ids[0]).indexOf("_")&&(s=s.split("_")[0]),!/[a-zA-Z0-9]{11}/.test(s)&&g&&g.monitor&&g.monitor(94,"vid:"+s+";url="+i,39),n({vidInfo:[{vid:s,is_mp_video:0}]})}catch(t){n({vidInfo:[]})}},onerror:function(){n({vidInfo:[]})}})}else(s=this.getVidFromUrl(i))?(-1!==s.indexOf("_")&&(s=s.split("_")[0]),!/[a-zA-Z0-9]{11}/.test(s)&&g&&g.monitor&&g.monitor(94,"vid:"+s+";url="+i,39),n({vidInfo:[{vid:s,is_mp_video:0}]})):e&&e(-1)},getUrlParam:function(t,e){var i=t+"=",n=(e=e||document.location.toString()).indexOf(i)
if(-1===n)return""
var s=e.indexOf("&",n),o=e.indexOf("?",n)
return-1!==o&&(-1===s||o<s)&&(s=o,o=e.indexOf("#",n)),-1!==o&&(-1===s||o<s)&&(s=o),-1===s?e.substring(n+i.length):e.substring(n+i.length,s)},getVidFromUrl:function(t){t=t||window.location.toString()
var e=this.getUrlParam("vid",t),i=void 0
if(e||(i=t.match(/\/\w{15}\/(\w+)\.html/))&&(e=i[1]),!e){var n=t.match(/\/page\/\w{1}\/\w{1}\/\w{1}\/(\w+)\.html/),s=t.match(/\/(page|play)\/+(\w{11})\.html/),o=t.match(/\/(page)\/(\w+)\.html/)
n?e=n[1]:s?e=s[2]:o&&(e=o[2])}return e||(i=t.match(/\/boke\/gplay\/\w+_\w+_(\w+)\.html/))&&(e=i[1]),encodeURIComponent(e)},handleAppmsgUrl:function(t,e){r.get({url:"/cgi-bin/video_mgr?action=get_vid_list&url="+window.encodeURIComponent(t)},function(t){t&&t.vid_info_list&&0<t.vid_info_list.length?e({vidInfo:t.vid_info_list}):e()},function(){e()})},handleVideoDetailUrl:function(t,e){var i=t.match(/[\?&]vid\=([^&]*)/)
i&&i[1]?e({vidInfo:[{vid:i[1],is_mp_video:0}]}):e()},handleMpPlayerUrl:function(t,e){var i=t.match(/[\?&]vid\=([^&]*)/)
i&&i[1]?e({vidInfo:[{vid:i[1],is_mp_video:1}]}):e()},durationStr2Sec:function(t){if(!t)return 0
for(var e=(t=t.replace(/：/g,":")).split(":"),i=0,n=1,s=e.length-1;0<=s;s--)i+=e[s]*n,n*=60
return i},getPlayurlByVid:function(t,e,i,n,s){return s=!0===s,i=i||500,n=n||375,e?"https://mp.weixin.qq.com/mp/readtemplate?t=pages/video_player_tmpl&action=mpvideo&auto=0&vid="+t:s?"https://v.qq.com/txp/iframe/player.html?vid="+t+"&width="+i+"&height=auto":"https://v.qq.com/iframe/preview.html?width="+i+"&height="+n+"&auto=0&vid="+t},isWeiboVideo:function(t){return!(!t||!t.substr)&&"04"===t.substr(1,2)},selectVideo:function(t){if(!1!==t.canSelect){var e=this.conf[this.tab],i=e.allowChooseLength
if(e.showSelected||this.selectedVideo.length!==i||this.isVideoChecked(t)||1===i)if(1===e.allowChooseLength){for(var n=0;n<e.list.length;n++)e.list[n].checked=e.list[n].aid===t.aid
t.checked=!0,e.selectedData=[t]}else{for(var s=!t.checked,o=0;o<e.list.length;o++)e.list[o].aid===t.aid&&(e.list[o].checked=s)
if(!e.showSelected)if(this.isVideoChecked(t)){var a=this.selectedVideoIdList.indexOf(t.aid)
e.selectedData.splice(a,1)}else{var r=d({},t)
r.title=this.formatTitle(r.title),e.selectedData.push(r)}for(var l=0;l<e.selectedData.length;l++)e.selectedData[l].aid===t.aid&&(e.selectedData[l].checked=s)}else this.$tipsErr(c.sprintf("最多选择%s个视频",i))}},changeViewToSelectedVideo:function(){this.conf[this.tab].showSelected=!0},changeViewToAllVideo:function(){this.conf[this.tab].showSelected=!1
for(var t=[],e=0;e<this.selectedVideo.length;e++)this.selectedVideo[e].checked&&t.push(this.selectedVideo[e])
this.conf[this.tab].selectedData=t},submit:function(){var t=this.conf[this.tab].selectedData.filter(function(t){return t.checked})
if(0!==t.length){if("library"===this.tab)"morevideo"===this.scene?this.$emit("select",t,this.tab,this.scene):1===this.conf[this.tab].allowChooseLength?(this.$emit("select",JSON.parse(JSON.stringify(t[0])),this.tab),window.WX_BJ_REPORT.BadJs.report("videoDialog",h.getVideoStatus(t[0]),{mid:"mmbizweb2:videoReport",info:t[0]})):(this.$emit("select",JSON.parse(JSON.stringify(t)),this.tab),window.WX_BJ_REPORT.BadJs.report("videoDialog",h.getVideoStatus(t),{mid:"mmbizweb2:videoReport",info:t}))
else{for(var e=this.getLinkType(this.conf.link.inputLink),i=t,n=[],s=0;s<i.length;s++){if(0===e&&this.isWeiboVideo(i[s].video_id))return void this.$tipsErr("该链接为腾讯微博视频网址，此处引用视频只支持已发布的微信公众号链接、视频详情链接或者腾讯视频链接")
var o={height:375,width:500,vid:i[s].video_id,subtype:e,url:this.getPlayurlByVid(i[s].video_id,+i[s].is_mp_video),title:i[s].title,duration:i[s].duration,play_length:i[s].play_length,cover:i[s].cover,video_id:i[s].video_id,content:i[s].video_id,is_mp_video:+i[s].is_mp_video,video_ori_status:i[s].ori_status,hit_nickname:i[s].hit_nickname}
n.push(o)}1===this.conf[this.tab].allowChooseLength?this.$emit("select",JSON.parse(JSON.stringify(n[0])),this.tab):this.$emit("select",JSON.parse(JSON.stringify(n)),this.tab)}this.hide()}},dialogVisibleChange:function(t){var e=this
if(t){if(this.initData(),this.needResize(),"library"===this.tab&&0<this.conf.library.selectedData.length){this.conf[this.tab].showSelected=!0
for(var i=this.conf.library.selectedData,n=0;n<i.length;n++)if(i[n].duration=this.formatDuration(i[n].duration),1===i[n].deleted){this.$tipsErr("已选择视频中包含已删除内容")
break}}this.getVideoData(1).then(function(t){e.pageChangeSucCb(t)}).catch(function(t){console.log(t),e.pageChangeErrCb()})}},isVideoChecked:function(t){return-1<this.selectedVideoIdList.indexOf(t.aid)},isVideoDisabled:function(t){return this.selectedVideo.length===this.conf[this.tab].allowChooseLength&&!this.isVideoChecked(t)&&1!==this.conf[this.tab].allowChooseLength||!t.canSelect},isCheckboxShow:function(){return 1<this.conf[this.tab].allowChooseLength},formatDuration:function(t){if(!t)return"00:00"
if(t&&"string"==typeof t&&-1<t.indexOf(":"))return 2===t.split(":").length&&4===t.length?"0"+t:t
t=parseInt(t,10)
var e=Math.floor(t/60/60)
t-=60*e*60
var i=Math.floor(t/60),n=t-60*i
return n<10&&(n="0"+n),i<10&&(i="0"+i),0<e?e+":"+i+":"+n:i+":"+n},formatTitle:function(t){return t.replace(/<\/?em>/g,"")},jump2upload:function(){window.openUrl(o.addBaseParm("/cgi-bin/appmsg?t=media/videomsg_edit&action=video_edit&type=15"),{},!0)}},computed:{submitBtnDisabled:function(){return 0===this.conf[this.tab].selectedData.filter(function(t){return t.checked}).length},selectedItemsShow:function(){return 1<this.conf.link.allowChooseLength},selectedLength:function(){return this.conf[this.tab].selectedData.filter(function(t){return t.checked}).length},selectedVideo:function(){return this.conf[this.tab].selectedData},selectedVideoIdList:function(){for(var t=[],e=0;e<this.selectedVideo.length;e++)t.push(this.selectedVideo[e].aid)
return t},showTabChoose:function(){return this.canuselink&&this.canusetxvideo},showSelected:function(){return this.conf[this.tab].showSelected},showSearch:function(){return"morevideo"===this.scene}},watch:{dialogShow:function(t){this.$emit("input",t)},value:function(t){!0===t?this.show():this.hide()}},filters:{formatUpdateTime:function(t){return s.formatDate(t,"YYYY-MM-DD HH:mm")},getVideoLength:function(t){return t.filter(function(t){return t.checked}).length}}})})
define("pages/modules/media_dialog/video_dialog/video_dialog.css.js", [], function (require, exports, module){module.exports = "@grid BreakPoints: {  xs: 0;  sm: 576px;  md: 768px;  lg: 992px;  xl: 1200px;}@container MaxWidths: {  xs: auto;  sm: 540px;  md: 720px;  lg: 960px;  xl: 1140px;}/*How to usefont-family: 'wechatnum';*/.more-video__wrp {  position: relative;}.more-video__wrp .weui-desktop-pagination {  padding-top: 0;}.more-video__wrp .weui-desktop-tab__navs {  padding: 0 32px;}.more-video__title {  font-size: var(--weuiDesktop_H4FontSize);  padding: 20px 0;  overflow: hidden;  text-align: right;}.more-video__title .weui-desktop-btn {  float: right;  margin-left: 15px;}.more-video__title .weui-desktop-search {  width: 250px;  float: right;}.more-video__lib {  padding: 0 32px;}.more-video__list {  height: 440px;  overflow-y: auto;  overflow-x: auto;  margin-right: -20px;}.more-video__list.tx-video__list {  height: 600px;}.more-video__list_single {  text-align: center;}.more-video__list_single .more-video__item {  float: none;  text-align: left;  display: inline-block;}.more-video__list_double .more-video__item {  width: 50%;}.more-video__item {  border: 2px solid transparent;  box-sizing: border-box;  float: left;  position: relative;  margin-bottom: 20px;  width: 100%;}.more-video__item .weui-desktop-icon-checkbox {  border: 0.85714286px solid #FFFFFF;  background: rgba(26, 27, 28, 0.3);  -ms-transform: scale(1.75);      transform: scale(1.75);  -ms-transform-origin: 0 0;      transform-origin: 0 0;  position: absolute;  top: 8px;  left: 8px;}.more-video__item .weui-desktop-form__checkbox:checked + .weui-desktop-icon-checkbox {  display: block;  border-color: var(--weuiDesktop_themeColor);  background: var(--weuiDesktop_themeColor);}.more-video__item .weui-desktop-form__checkbox:checked + .weui-desktop-icon-checkbox:before {  width: 18px;  height: 9px;  border-left-width: 2px;  border-bottom-width: 2px;  -ms-transform-origin: 23% 32%;      transform-origin: 23% 32%;}.search_input .weui-desktop-form__input {  border-radius: 3px 0 0 3px;}.search_ensure_button.weui-desktop-btn {  border-radius: 0 3px 3px 0;  line-height: 2.49999992;}.more-video__item-tips {  padding: 12px 20px 0 0;}.more-video__item-tips_sub {  color: var(--weuiDesktop_FG_Text_descColor);  padding-top: 20px;}.example-img__popover .example-img__wrp {  width: 223px;  height: 365px;}.more-video__item_selected {  border-color: transparent;}.more-video__item_selected .more-video__item-wrp::before {  content: \"\";  display: block;  width: 100%;  height: 100%;  border: 2px solid rgba(7, 193, 96, 0.3);  background: rgba(7, 193, 96, 0.1);  border-radius: 2px;  position: absolute;  left: 50%;  top: 50%;  -ms-transform: translate(-50%, -50%);      transform: translate(-50%, -50%);}.more-video__item_disabled .more-video__item-wrp::after {  content: \"\";  display: block;  position: absolute;  left: 0;  top: 0;  right: 0;  bottom: 0;  background: rgba(255, 255, 255, 0.5);  z-index: 10;}.more-video__item_disabled .more-video__item-wrp:hover:before {  display: none;}.more-video__item_disabled .weui-desktop-form__check-label {  opacity: 0;}.more-video__item-wrp {  height: 94px;  display: -ms-flexbox;  display: flex;  margin-right: 20px;  border-radius: 2px;  border: 1px solid var(--weuiDesktop_separateColor);  box-sizing: border-box;  position: relative;  z-index: 2;  cursor: pointer;}.more-video__item-wrp:hover:before {  content: \"\";  display: block;  width: 100%;  height: 100%;  border: 2px solid rgba(7, 193, 96, 0.3);  border-radius: 2px;  position: absolute;  left: 50%;  top: 50%;  -ms-transform: translate(-50%, -50%);      transform: translate(-50%, -50%);}.weui-desktop-simple-video__mask.weui-desktop-simple-video__mask_suc {  cursor: pointer;  padding: 0 8px;  border-radius: 16px;  height: 20px;  line-height: 20px;  bottom: 10px;  left: 10px;  display: -ms-flexbox;  display: flex;  -ms-flex-align: center;      align-items: center;}.weui-desktop-simple-video__mask {  position: absolute;  display: block;  text-align: center;  background: rgba(0, 0, 0, 0.6);}.icon-svg-modules-media-vedio-player {  background-image: url(\"data:image/svg+xml;charset=utf8, %3Csvg width='8' height='8' viewBox='0 0 8 8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M.726 7.934l6.892-3.488a.5.5 0 0 0 0-.892L.726.066A.5.5 0 0 0 0 .513v6.975a.5.5 0 0 0 .726.446z' fill-rule='nonzero' fill='%23FFF'/%3E%3C/svg%3E\");  width: 8px;  height: 8px;  margin-right: 4px;}.weui-desktop-simple-video__duration {  font-style: normal;  color: #fff;  vertical-align: middle;  font-size: var(--weuiDesktop_descFontSize);}.more-video__item-img {  width: 160px;  height: 100%;  background-position: center center;  background-size: cover;  -ms-flex-negative: 0;      flex-shrink: 0;}.more-video__item-content {  padding: 10px 20px;  height: 100%;  box-sizing: border-box;  display: -ms-flexbox;  display: flex;  -ms-flex-direction: column;      flex-direction: column;  -ms-flex-pack: justify;      justify-content: space-between;  -ms-flex: 1;      flex: 1;}.more-video__item-title {  display: -webkit-box;  -webkit-line-clamp: 2;  -webkit-box-orient: vertical;  overflow: hidden;  text-overflow: ellipsis;  word-wrap: break-word;  -webkit-hyphens: auto;  -ms-hyphens: auto;      hyphens: auto;}.more-video__item-title em {  color: var(--weuiDesktop_themeColor);  font-style: normal;}.more-video__item-desc {  color: var(--weuiDesktop_FG_Text_descColor);}.more-video__footer {  position: relative;}.more-video__footer .weui-desktop-btn {  margin-right: 20px;}.more-video__footer .weui-desktop-btn:last-child {  margin-right: 0;}.more-video__item-status {  margin-left: 5px;  float: right;}.more-video__item-status-desc {  position: absolute;  width: 100%;  line-height: 50px;  padding: 0 15px;  box-sizing: border-box;  background-color: rgba(250, 250, 250, 0.95);  color: var(--weuiDesktop_FG_Text_descColor);  z-index: 11;}.more-video__footer-selection {  position: absolute;  left: 0;  line-height: 36px;}.more-video__footer-selection span {  margin: 0 4px;  color: var(--weuiDesktop_FG_Text_linkColor);  cursor: pointer;}.more-video__loading {  text-align: center;  height: 440px;  display: -ms-flexbox;  display: flex;  -ms-flex-align: center;      align-items: center;  -ms-flex-pack: center;      justify-content: center;}.more-video__empty {  height: 100%;  display: -ms-flexbox;  display: flex;  -ms-flex-align: center;      align-items: center;  -ms-flex-pack: center;      justify-content: center;  color: var(--weuiDesktop_FG_Text_descColor);}.more-video__link {  margin: 60px 32px 40px;}.more-video__link .weui-desktop-form__label {  width: 7em;}.more-video__link .weui-desktop-form__control-group {  display: -ms-flexbox;  display: flex;  width: 650px;  margin: 0 auto 30px;}.more-video__link .weui-desktop-form__control-group .weui-desktop-form__controls {  -ms-flex: 1;      flex: 1;  display: -ms-flexbox;  display: flex;  -ms-flex-align: start;      align-items: flex-start;}.more-video__link .weui-desktop-form__control-group .weui-desktop-btn_default {  margin-left: -1px;}.more-video__link .weui-desktop-form__input-area {  -ms-flex: 1;      flex: 1;}";});define("pages/modules/utils/loadscript.js",[],function(e,o,t){"use strict"
var y=1
t.exports={load:function e(o){var n=0<arguments.length&&void 0!==o?o:{},t=void 0
t="number"!=typeof n.retry?1:n.retry
var r=document.createElement("script"),a=document.head||document.getElementsByTagName("head")[0]||document.documentElement,i=n.url+"&t="+Math.random(),d=n.callbackName,l="uninitialized",u=void 0
u=void 0===n.successCode?200:n.successCode
var c=void 0
c=void 0===n.timeoutCode?500:n.timeoutCode
var s=void 0
s=void 0===n.scriptErrorCode?400:n.scriptErrorCode
function m(e){null!==r&&!0!==f&&(f=!0,v&&(clearTimeout(v),v=null),r.onload=null,r.onreadystatechange=null,r.onerror=null,a&&r.parentNode&&a.removeChild(r),r=null,d&&-1===d.indexOf(".")&&(window[d]=null),e!==u&&"loaded"!==l&&"function"==typeof n.onerror&&n.onerror(e))}var f=!1,v=null
if(d&&"function"==typeof n.callback){var p=d;-1===d.indexOf(".")&&(window[d]&&(d+=++y),window[d]=function(){for(var e=arguments.length,o=Array(e),t=0;t<e;t++)o[t]=arguments[t]
l="loaded",n.callback.apply(null,o)}),i=i.replace("="+p,"="+d)}r.onreadystatechange=function(){var e=navigator.userAgent.toLowerCase();-1===e.indexOf("opera")&&-1!==e.indexOf("msie")&&!/loaded|complete/i.test((void 0).readyState)||m("loaded"===l?u:s)},r.onload=r.onreadystatechange,r.onerror=function(){if(0<t)return n.retry=t-1,v&&(clearTimeout(v),v=null),void e(n)
m(s)},n.timeout&&(v=setTimeout(function(){m(c)},parseInt(n.timeout,10))),l="loading",r.charset="utf-8",setTimeout(function(){r.src=i
try{a.insertBefore(r,a.lastChild)}catch(e){}},0)}}})
define("pages/modules/media_dialog/video_dialog/video_dialog.tpl.js",[],function(e,i,s){return'<mp-dialog ref="videoDialog" :title=\'dialogTitle\' :width="960" v-model="dialogShow" @close="closeDialog" @visible-change="dialogVisibleChange" rootElm="#vue_app">  <div class="more-video__wrp">        <mp-tab :tabs="tabs" :selected="tab" @click="tabChange" v-if="showTabChoose" />        <div class="more-video__lib" v-show="tab === \'library\'" ref="libPanel">      <div class="more-video__title" v-if="conf.library.showUpload || showSearch">        <mp-button @click="uploadVideo" v-if="conf.library.showUpload">本地上传</mp-button>        <mp-search v-if="showSearch" placeholder="输入标题关键词" v-model="searchData" clear @search="onSearch" @clear="onSearch"></mp-search>      </div>            <p class="weui-desktop-media-tips weui-desktop-media-tips_loading"  v-show="conf.library.loading && !conf.library.showSelected" :style="{ height: loadingHeight }">加载中</p>            <p class="weui-desktop-media-tips" v-if="showSearch" v-show="searchKey && !conf.library.showSelected && !conf.library.loading && conf.library.list.length === 0" :style="{ height: loadingHeight }">没有匹配的搜索结果，只可搜索已群发的视频 <a href="javascript:;" @click="searchData = \'\', onSearch()">返回全部</a></p>            <ul ref="videoList" class="more-video__list more-video__list_double" v-show="!conf.library.showSelected && !conf.library.loading && !(searchKey && conf.library.list.length === 0)" :style="{ height: height }">        <li class="more-video__empty" v-if="conf.library.list.length === 0">暂无视频</li>        <li :class="{          \'more-video__item\': true,          \'more-video__item_selected\': isVideoChecked(item) && item.checked && item.canSelect,          \'more-video__item_disabled\': isVideoDisabled(item) && !item.checked        }" v-for="item in conf.library.list" @mouseenter="hoverItem = item" @mouseleave="hoverItem = null">          <div class="more-video__item-wrp" @click.stop.prevent="selectVideo(item)">            <div class="more-video__item-img" :style="\'background-image:url(\' + item.cover + \')\'"></div>            <div class="more-video__item-content">              <div class="more-video__item-title"><b class="weui-desktop-key-tag" v-show="item.tag">{{item.tag}}</b><span v-html="item.title"></span></div>              <div class="more-video__item-desc">                {{item.update_time | formatUpdateTime}}                                <span class="more-video__item-status">{{item.statusMsg}}</span>              </div>            </div>                        <div class="more-video__item-status-desc" v-show="hoverItem === item">{{item.statusInfo}}</div>            <mp-checkbox :value="isVideoChecked(item) && item.checked && item.canSelect" v-bind:disabled="isVideoDisabled(item) && !item.checked" v-show="isCheckboxShow(item)"></mp-checkbox>            <span class="weui-desktop-simple-video__mask weui-desktop-simple-video__mask_suc" v-if="item.duration">              <i class="icon-svg-modules-media-vedio-player"></i><em class="weui-desktop-simple-video__duration">{{item.duration}}</em>            </span>          </div>        </li>      </ul>            <ul class="more-video__list" v-show="conf.library.showSelected" :style="{ height: loadingHeight}">        <li class="more-video__empty" v-if="selectedVideo.length === 0">暂无视频</li>        <li :class="{          \'more-video__item\': true,          \'more-video__item_selected\': isVideoChecked(item) && item.checked        }" v-for="item in selectedVideo">          <div class="more-video__item-wrp" @click.stop.prevent="selectVideo(item)">            <div class="more-video__item-img" :style="\'background-image:url(\' + item.cover + \')\'"></div>            <div class="more-video__item-content">              <div class="more-video__item-title">{{ item.title }}</div>              <div class="more-video__item-desc">                {{item.update_time | formatUpdateTime}}                <span class="more-video__item-status" v-if="item.deleted === 1">已删除</span>              </div>            </div>            <mp-checkbox :value="isVideoChecked(item) && item.checked"></mp-checkbox>            <span class="weui-desktop-simple-video__mask weui-desktop-simple-video__mask_suc">              <i class="icon-svg-modules-media-vedio-player"></i><em class="weui-desktop-simple-video__duration">{{item.duration}}</em>            </span>          </div>        </li>      </ul>      <mp-pagination        v-show="!conf.library.showSelected && !conf.library.loading"        :per-page="conf.library.pageLen"        :total-num="conf.library.totalCount"        :current="conf.library.currentPage"        :show-endpage="!searchKey"        :show-jumper="!searchKey"        @page-change="pageChange"      ></mp-pagination>    </div>        <div class="more-video__link" v-show="tab === \'link\'" :style="{ height: linkHeight}">      <mp-form v-show="!conf.link.showSelected" @submit.native.prevent>        <mp-form-item label="视频/图文网址">          <mp-input type="text"          class="search_input"          :status="conf.link.linkInputStatus"          :require="true"          v-model="conf.link.inputLink"          placeholder="支持微信公众号文章链接，视频详情页链接和腾讯视频链接"          @keydown.enter="searchVideo">          <span slot="message">只支持已发布的微信公众号链接、视频详情页链接和腾讯视频链接</span>          </mp-input>          <mp-button class="search_ensure_button" @click="searchVideo" :disabled="conf.link.inputLink === \'\'">确定</mp-button>        </mp-form-item>      </mp-form>            <p class="weui-desktop-media-tips weui-desktop-media-tips_loading" style="height: 385px;" v-show="conf.link.loading && !conf.link.showSelected && !conf.link.showLinkInfo">加载中</p>      <ul class="more-video__list tx-video__list" :class="{\'more-video__list_single\': conf.link.list.length === 1}" v-show="!conf.link.showSelected && !conf.link.loading && conf.link.showLinkInfo">        <li class="more-video__empty" v-show="conf.link.list.length === 0">暂无视频</li>                        <div style="float: left; width: 50%;">          <li :class="{            \'more-video__item\': true,            \'more-video__item_selected\': isVideoChecked(item) && item.checked,            \'more-video__item_disabled\': isVideoDisabled(item)          }" v-for="(item, index) in conf.link.list" :key="item.aid" v-if="(index % 2) === 0">            <div class="more-video__item-wrp" @click.stop.prevent="selectVideo(item)" @mouseenter="hoverItem = item" @mouseleave="hoverItem = null">              <div class="more-video__item-img" :style="\'background-image:url(\' + item.cover + \')\'"></div>              <div class="more-video__item-content">                <div class="more-video__item-title">{{item.title}}</div>                <div class="more-video__item-desc">                  <span v-if="item.is_mp_video === 0">                    来自腾讯视频                  </span>                  <span v-else>                    {{item.update_time | formatUpdateTime}}                  </span>                  <span class="more-video__item-status">{{item.statusMsg}}</span>                </div>              </div>              <div class="more-video__item-status-desc" v-show="hoverItem === item">{{item.statusInfo}}</div>              <mp-checkbox :value="isVideoChecked(item) && item.checked" v-bind:disabled="isVideoDisabled(item)" v-show="isCheckboxShow(item)"></mp-checkbox>              <span class="weui-desktop-simple-video__mask weui-desktop-simple-video__mask_suc">                <i class="icon-svg-modules-media-vedio-player"></i><em class="weui-desktop-simple-video__duration">{{item.duration}}</em>              </span>            </div>            <div class="js_qvideo_ori_tips more-video__item-tips" v-if="((item.is_mp_video === 0 && !isVideoDisabled(item)) || item.risk_prompt_type === 1) && (isVideoChecked(item) && item.checked)">              <div class="weui-desktop-msg__inner weui-desktop-msg_mini">              <span class="weui-desktop-msg__hd">                <i class="weui-desktop-icon_msg weui-desktop-icon-info"></i>              </span>              该视频如命中公众平台原创视频，则按 <mp-popover class="example-img__popover" trigger="hover"><img class="example-img__wrp" src="https://res.wx.qq.com/op_res/PIadoJVzA2GuMzzSa3DZVy8WRQIgTbsEpNnO3NmdT3WOBZ0GiJLZxqHak-kyzWqq"><a href="javascript:void(0)" slot="target">转载样式</a></mp-popover> 群发。<mp-popover class="example-img__popover" trigger="hover">你当前选择的视频来自腾讯视频。建议上传并群发公众号视频，不仅可声明原创获得原创保护和更高的广告分成收益，还有更多内容拓展和商业化能力。<a target="_blank" href="https://support.qq.com/products/66522/faqs/55655">详情</a><a href="javascript:void(0)" slot="target">详情</a></mp-popover></div>            </div>            <div class="js_qvideo_ori_tips more-video__item-tips" v-if="item.showOriTips === 1 && (isVideoChecked(item) && item.checked)">              <div class="weui-desktop-msg__inner weui-desktop-msg_mini">              <span class="weui-desktop-msg__hd">                <i class="weui-desktop-icon_msg weui-desktop-icon-info"></i>              </span>              该视频已被他人先声明原创，将按 <mp-popover class="example-img__popover" trigger="hover"><img class="example-img__wrp" src="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFgtDgOjO0ruYzNX578lMxf4icPtgrZjErPR1BjfL2ynMk6TrQoDkpOicrm9vW37j3hrwTFkDzN19oGA/0?wx_fmt=png"><a href="javascript:void(0)" slot="target">转载样式</a></mp-popover> 群发。</div>            </div>          </li>        </div>                 <div style="float: left; width: 50%;">          <li :class="{            \'more-video__item\': true,            \'more-video__item_selected\': isVideoChecked(item) && item.checked,            \'more-video__item_disabled\': isVideoDisabled(item)          }" v-for="(item, index) in conf.link.list" :key="item.aid" v-if="(index % 2) === 1">            <div class="more-video__item-wrp" @click.stop.prevent="selectVideo(item)" @mouseenter="hoverItem = item" @mouseleave="hoverItem = null">              <div class="more-video__item-img" :style="\'background-image:url(\' + item.cover + \')\'"></div>              <div class="more-video__item-content">                <div class="more-video__item-title">{{item.title}}</div>                <div class="more-video__item-desc">                  <span v-if="item.is_mp_video === 0">                    来自腾讯视频                  </span>                  <span v-else>                    {{item.update_time | formatUpdateTime}}                  </span>                  <span class="more-video__item-status">{{item.statusMsg}}</span>                </div>              </div>              <div class="more-video__item-status-desc" v-show="hoverItem === item">{{item.statusInfo}}</div>              <mp-checkbox :value="isVideoChecked(item) && item.checked" v-bind:disabled="isVideoDisabled(item)" v-show="isCheckboxShow(item)"></mp-checkbox>              <span class="weui-desktop-simple-video__mask weui-desktop-simple-video__mask_suc">                <i class="icon-svg-modules-media-vedio-player"></i><em class="weui-desktop-simple-video__duration">{{item.duration}}</em>              </span>            </div>            <div class="js_qvideo_ori_tips more-video__item-tips" v-if="((item.is_mp_video === 0 && !isVideoDisabled(item)) || item.risk_prompt_type === 1) && (isVideoChecked(item) && item.checked)">              <div class="weui-desktop-msg__inner weui-desktop-msg_mini">              <span class="weui-desktop-msg__hd">                <i class="weui-desktop-icon_msg weui-desktop-icon-info"></i>              </span>              该视频如命中公众平台原创视频，则按 <mp-popover class="example-img__popover" trigger="hover"><img class="example-img__wrp" src="https://res.wx.qq.com/op_res/PIadoJVzA2GuMzzSa3DZVy8WRQIgTbsEpNnO3NmdT3WOBZ0GiJLZxqHak-kyzWqq"><a href="javascript:void(0)" slot="target">转载样式</a></mp-popover> 群发。<mp-popover class="example-img__popover" trigger="hover">你当前选择的视频来自腾讯视频。建议上传并群发公众号视频，不仅可声明原创获得原创保护和更高的广告分成收益，还有更多内容拓展和商业化能力。<a target="_blank" href="https://support.qq.com/products/66522/faqs/55655">详情</a><a href="javascript:void(0)" slot="target">详情</a></mp-popover></div>            </div>            <div class="js_qvideo_ori_tips more-video__item-tips" v-if="item.showOriTips === 1 && (isVideoChecked(item) && item.checked)">              <div class="weui-desktop-msg__inner weui-desktop-msg_mini">              <span class="weui-desktop-msg__hd">                <i class="weui-desktop-icon_msg weui-desktop-icon-info"></i>              </span>              该视频已被他人先声明原创，将按 <mp-popover class="example-img__popover" trigger="hover"><img class="example-img__wrp" src="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFgtDgOjO0ruYzNX578lMxf4icPtgrZjErPR1BjfL2ynMk6TrQoDkpOicrm9vW37j3hrwTFkDzN19oGA/0?wx_fmt=png"><a href="javascript:void(0)" slot="target">转载样式</a></mp-popover> 群发。</div>            </div>                      </li>        </div>              </ul>            <ul class="more-video__list" v-show="conf.link.showSelected">        <li class="more-video__empty" v-if="selectedVideo.length === 0">暂无视频</li>        <li :class="{          \'more-video__item\': true,          \'more-video__item_selected\': isVideoChecked(item) && item.checked        }" v-for="item in selectedVideo" :key="item.aid">          <div class="more-video__item-wrp" @click.stop.prevent="selectVideo(item)">            <div class="more-video__item-img" :style="\'background-image:url(\' + item.cover + \')\'"></div>            <div class="more-video__item-content">              <div class="more-video__item-title">{{item.title}}</div>              <div class="more-video__item-desc">                {{item.update_time | formatUpdateTime}}                <span class="more-video__item-status" v-if="item.deleted === 1">已删除</span>              </div>            </div>            <mp-checkbox :value="isVideoChecked(item) && item.checked"></mp-checkbox>            <span class="weui-desktop-simple-video__mask weui-desktop-simple-video__mask_suc">              <i class="icon-svg-modules-media-vedio-player"></i><em class="weui-desktop-simple-video__duration">{{item.duration}}</em>            </span>          </div>        </li>      </ul>    </div>  </div>  <div slot="footer" class="more-video__footer">    <div class="more-video__footer-selection" v-show="selectedItemsShow">      已选择      <span @click="changeViewToSelectedVideo">{{selectedLength}}/ {{conf[tab].allowChooseLength}}条视频</span>      <span @click="changeViewToAllVideo" v-show="showSelected">返回全部</span>    </div>    <mp-button :disabled="submitBtnDisabled" type="primary" @click="submit">确定</mp-button>    <mp-button type="default" @click="closeDialog">取消</mp-button>  </div></mp-dialog>'})
define("pages/media/modules/video_status/video_status.js",["pages/modules/utils/cgi.js"],function(i,t,e){"use strict"
var u=i("pages/modules/utils/cgi.js")
function n(i){var t=0
if(void 0!==i.create_time&&(t=parseInt(i.create_time,10)<1453914e3),0===i.status||1===i.is_mp_video&&void 0!==i.is_mp_video_original_check_finish&&1!==i.is_mp_video_original_check_finish&&3===i.status||3===i.status&&0===i.video_ori_status&&(void 0===i.create_time||!t)&&0===i.is_mp_video_original_check_finish)return 1===i.is_mp_video&&1===i.is_mp_video_in_huiliu_check?10:0
if(1===i.status)return 1
if(10===i.status)return 10
if(2===i.status)return 1===i.is_mp_video&&(1!==i.is_mp_video||0===i.mp_video_xinan_check_result_code)&&1===i.is_mp_video&&0!==i.mp_video_modify_check_result_code?8:2
if(3!==i.status)return 4===i.status?1===i.ext_status?2:4:5===i.status?5:9===i.status?9:0<i.status?i.status:-1
var e=Number(i.ori_fail_reason)
return 3===i.video_ori_status&&i.mp_video_fail_detail_wording&&i.is_mp_video||3===i.video_ori_status&&-1<[1,3,5].indexOf(e)||2===i.video_ori_status||"2"===i.video_ori_status||0===i.video_ori_status&&1===i.is_mp_video_original_check_finish?1===i.video_reprint_status?11:2===i.video_reprint_status?12:1===i.applyori?6:7:3}e.exports={rollStatus:function(i,t,e){return function s(_,o,r){r.timer=setTimeout(function(){u.get({url:"/cgi-bin/appmsg?action=get_video_info&videoid="+_,success:function(i){var t=0<arguments.length&&void 0!==i?i:{}
if(0===t.base_resp.ret){var e=n(t.video_info.multi_item[0])
0===e||4===e?(o(e,t.video_info),s(_,o,r)):o(e,t.video_info)}}})},1e3)}(i,t,e)},getVideoStatus:function(i){return n(i)},canModify:function(i){var t=n(i)
return 3===t||6===t||7===t||8===t},canPlay:function(i){var t=n(i)
return 3===t||6===t||7===t||8===t},canMsgSend:function(i){var t=n(i)
return 3===t||6===t||7===t||(0===t||4===t||10===t)}}})
define("pages/media/modules/common/getVinfo.js",["pages/modules/utils/loadscript.js","pages/modules/utils/cgi.js"],function(e,i,t){"use strict"
function o(e,i){var t=0<arguments.length&&void 0!==e?e:"",r=1<arguments.length&&void 0!==i?i:""
return r&&r!==16/9?"http://shp.qpic.cn/qqvideo/0/"+t+"/400":"http://shp.qpic.cn/qqvideo_ori/0/"+t+"_496_280/0"}function m(e,i){var t="视频加载失败",r=""
switch(+e){case-4:case-5:case-3:r="因版权限制，该视频不支持添加"
break
case 61:r="该视频不存在"
break
case 62:r="该视频已下架"
break
case 63:case 65:case 67:r="视频加载失败"
break
case 69:r="视频格式不支持移动端观看"
break
case 71:case 73:case 74:r="视频加载失败"
break
case 80:switch(+i){case 1:r="IP地址所在地区暂不支持播放"
break
case 2:default:r="因版权限制，该视频不支持添加"}break
case 81:case 82:r="视频加载失败"
break
case 83:switch(+i){case-1:r=t
break
case-2:default:r="因版权限制，该视频不支持添加"}break
case 84:r="视频加载失败"
break
default:r=t}return r}function a(e){var p=0<arguments.length&&void 0!==e?e:{},i="https://h5vv.video.qq.com/getvinfo?vid=#vid#&dtype=1&otype=json&callback=video_dynamic_callback&appVer=1&encryptVer=6.3&platform=61001&cKey=#ckey#&sdtfrom=v3060"
i=i.replace("#vid#",p.vid).replace("#ckey#",p.ckey),i+="&device=60401&use_proxy_sdk=0"
var _=+new Date
r({url:i,timeout:1e4,callbackName:"video_dynamic_callback",callback:function(e){var i=0<arguments.length&&void 0!==e?e:{},t=+new Date-_
void 0===i.em&&(i.em=0)
var r="",o=+i.em,a=void 0
if(0==+i.em){if(0<i.exem?o=-4:0==+i.exem&&i.vl&&i.vl.vi&&i.vl.vi[0]&&8==+i.vl.vi[0].st&&(o=0<i.preview?-5:-3),0!==o||i.vl&&i.vl.vi&&i.vl.vi[0]||(o=-2),0!==o&&(r=m(+o,+i.exem)),i.vl&&i.vl.vi&&i.vl.vi[0]){var c=i.vl.vi[0]
if(a={newVid:c.lnk,time:c.td,title:c.ti,width:c.vw,height:c.vh,file_size:c.fs,rate:Math.round(c.fs/1024*8/c.td)},c.ul&&c.ul.ui&&c.ul.ui[0]){var n=c.ul.ui[0],s=n.url+c.fn,l=i.fl,d=""
if(l&&0<l.cnt)for(var v=l.fi,f=0;f<v.length;f++)if(1==+v[f].sl){d=v[f].name,a.resolution=(v[f].cname||"").replace(/^.*;\((:?.*)P\)$/,"$1")||0
break}a.format=d,a.vt=n.vt
var u=""
1==+n.dt?u="tflv":2!=+n.dt&&0!=+n.dt||(u="mp4"),a.totalUrl=[s,-1!==s.indexOf("?")?"&":"?","vkey=",c.fvkey,"&sdtfrom=","&type=",u,"&platform=","&fmt=",d,"&level=",c.level,"&br=",c.br,"&sp=",c.sp].join("")}}}else r=m(+o,+i.exem)
p.onSuc({data:a,oriData:i,cTime:t,errMsg:r||"",retCode:o})},onerror:function(e){var i=void 0,t=+new Date-_
switch(+e){case 400:i=-22
break
case 500:i=-21
break
default:i=-23}"function"==typeof p.onError&&p.onError(i,{retCode:i,cTime:t,errMsg:""})}})}var r=e("pages/modules/utils/loadscript.js").load,s=e("pages/modules/utils/cgi.js")
t.exports={getQQVideoUrlInfo:a,getInfoByVid:function(e){var t=0<arguments.length&&void 0!==e?e:{},r=void 0,i=void 0
r="function"==typeof t.onSuccess?t.onSuccess:function(){},i="function"==typeof t.onError?t.onError:function(){},s.post({url:"/cgi-bin/getvideockey?",data:{vid:t.vid}},function(e){e&&e.base_resp&&0==+e.base_resp.ret&&e.ckey?a({vid:t.vid,ckey:e.ckey,onSuc:function(e){var i=0<arguments.length&&void 0!==e?e:{}
i.data||(i.data={}),i.data.p4_3=o(t.vid,4/3),i.data.p16_9=o(t.vid,16/9),r(i)},onError:function(){i({code:3})}}):i({code:2,ckeyResp:e})},function(){i({code:1})})},getMpVideoInfo:function(e){var i=void 0,t=void 0
i="function"==typeof e.onSuccess?e.onSuccess:function(){},t="function"==typeof e.onError?e.onError:function(){}
function a(e){2===c&&!0!==o&&(o=!0,n&&r||(e="err"),"err"===e?t({resp:{},msg:"系统繁忙，请稍后再试"}):(n.data.cover=r,i(n)))}var c=0,r="",n=null,o=!1
s.get({url:"/mp/videoplayer?action=get_mp_video_play_url",data:{__biz:e.biz||"",mid:e.mid||"",idx:e.idx||"",vid:e.vid||""}},function(e){c++
var i=null,t=""
if(e&&e.base_resp&&0==+e.base_resp.ret)if(1==+e.is_mp_video_delete)t="该视频已被发布者删除"
else if(1==+e.is_mp_video_forbid)t="该视频因违规已下架"
else if(1==+e.is_mp_video_transing)t="正在转码，转码完成后可播放"
else if(1==+e.is_mp_video_checking)t="审核中"
else if(1==+e.is_mp_video_check_fail)t="审核失败"
else if(e.url_info&&0<e.url_info.length){var r=e.url_info[0],o=Math.floor(r.duration_ms/1e3)
i={time:o,title:e.title||"",width:r.width,height:r.height,file_size:r.filesize,totalUrl:r.url,rate:Math.round(r.filesize/1024*8/o),cover:""}}else t="系统繁忙，请稍后再试"
else t="当前视频不存在，暂无法观看"
n={resp:e,data:i=i||{cover:""},err_msg:t},a()},function(){c++,a("err")}),s.get({url:"/mp/videoplayer?action=get_mp_video_cover",data:{vid:e.vid||""}},function(e){c++,e&&e.base_resp&&0==+e.base_resp.ret&&e.url?(r=e.url,a()):a("err")},function(){c++,a("err")})}}})
define("pages/modules/media_dialog/red_package_cover_dialog/redPackageCoverDialog4Web1.js",["pages/modules/media_dialog/red_package_cover_dialog/red_package_cover_dialog.js"],function(e,a,o){"use strict"
function d(){return{defaultShow:!1,isShow:!1,appmsgid:"",scene:"send",type:"select",warnfocustype:"opentab",item:[],title:"",inserteddata:[]}}o.exports={getParams:d,bindEvent:function(a){a.eventBus.$on("requireRedPackageCoverDialog",function(){a.isRequired||(e("pages/modules/media_dialog/red_package_cover_dialog/red_package_cover_dialog.js"),a.isRequired=!0)}),a.eventBus.$on("showRedPackageCoverDialog",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}
a.eventBus.$emit("requireRedPackageCoverDialog"),function(e,a){var o=d()
for(var i in a)void 0!==o[i]&&(o[i]=a[i])
for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e.params[r]=o[r])
e.params.isShow=!0,e.params.defaultShow=!0}(a,e),a.eventBus.$emit("update-component",{key:"mp-red-package-cover-dialog",params:a.params})})},close:function(e){e.eventBus.$emit("showRedPackageCoverDialog_callback",e.data)}}})
define("pages/modules/media_dialog/red_package_cover_dialog/red_package_cover_dialog.js",["vue-weui/src/dialog/dialog.js","vue-weui/src/step/step.js","vue-weui/src/step/step_item.js","pages/modules/table/table.js","vue-weui/src/pagination/pagination.js","vue-weui/src/button/button.js","vue-weui/src/checkbox/checkbox.js","vue-weui/src/popover/popover.js","pages/modules/media_dialog/red_package_cover_dialog/red_package_cover_dialog.css.js","pages/modules/dbCache/dbCache.js","pages/modules/media_dialog/red_package_cover_dialog/red_package_cover_dialog.tpl.js","pages/modules/utils/cgi.js","pages/modules/utils/time.js","pages/modules/utils/str_util.js"],function(e,t,i){"use strict"
e("vue-weui/src/dialog/dialog.js"),e("vue-weui/src/step/step.js"),e("vue-weui/src/step/step_item.js"),e("pages/modules/table/table.js"),e("vue-weui/src/pagination/pagination.js"),e("vue-weui/src/button/button.js"),e("vue-weui/src/checkbox/checkbox.js"),e("vue-weui/src/popover/popover.js"),e("pages/modules/media_dialog/red_package_cover_dialog/red_package_cover_dialog.css.js")
var a=e("pages/modules/dbCache/dbCache.js"),r=e("pages/modules/media_dialog/red_package_cover_dialog/red_package_cover_dialog.tpl.js"),s=e("pages/modules/utils/cgi.js"),o=e("pages/modules/utils/time.js"),c=e("pages/modules/utils/str_util.js"),d="masssendMusicCheck",n=3e5
Vue.component("mp-red-package-cover-dialog",{template:r,props:{value:{type:Boolean,default:!1},appmsgid:{type:String,default:""},scene:{type:String,default:"send"},type:{type:String,default:"select"},warnfocustype:{type:String,default:"opentab"},title:{type:String,default:""},item:{type:Array,default:[]},inserteddata:{type:Array,default:[]}},data:function(){var e={head:[{title:"红包封面",key:"name"}],body:this.item},t="",i="",r=""
"confirm"===this.type?(e.head.push({title:"剩余封面数",key:"left_count"}),e.head.push({title:"所属文章",key:"appmsg_title"}),t="继续群发",i="封面数目确认",r=this.title||"请确认红包封面的数目后继续群发"):"warn"===this.type&&(e.head.push({title:"所属文章",key:"appmsg_title"}),e.head.push({title:"不可用原因",key:"statusStr"}),t="去修改",i="校验提醒",r="以下红包封面不可用，请删除或者重新选择")
for(var s={1:"当前可领取个数为0",2:"非本公众号的封面",3:"封面已被下架/冻结"},a=0,o=this.item.length;a<o;a++){var c=this.item[a]
c.left_count+="",c.statusStr=s[c.status]||"封面状态异常"}return{dialogShow:!1,dialogMainTitle:r,confirmTitle:i,confirmOkBtnText:t,confirmTableData:e,cacheWin:{},selectStep:1,gettingOrder:!1,orderList:[],gettingSubOrder:!1,subOrderList:[],orderTotalNum:0,orderPerPage:10,orderCurPage:1,subOrderTimeStr:"",subOrderTotalNum:0,subOrderPerPage:10,subOrderCurPage:1,selectedOrder:null,selectedSubList:[],maxSubListSelectedCount:10,okBtnLoading:!1,insertedOrderid:this.inserteddata.map(function(e){return e.order_id})}},watch:{value:function(e){!0===e?this.show():this.hide()},dialogShow:function(e){this.$emit("input",e)},canSelectSubList:function(e){!1===e&&this.$tipsErr(c.sprintf("最多选择%s条",this.maxSubListSelectedCount))}},mounted:function(){!0===this.value&&this.show()},computed:{okBtnDisabled:function(){return!(0<this.selectedSubList.length)},selectedRedPacketCoverNum:function(){for(var e=0,t=0,i=this.selectedSubList.length;t<i;t++){var r=this.selectedSubList[t]
r.checked&&(e+=r.remain_count)}return e},canSelectSubList:function(){return!(this.selectedSubList.length>=this.maxSubListSelectedCount)}},methods:{show:function(){!0!==this.dialogShow&&(this.dialogShow=!0,"select"===this.type&&this.getOrderList({page:1}))},hide:function(){!1!==this.dialogShow&&(this.dialogShow=!1)},dialogClose:function(e){var t=0<arguments.length&&void 0!==e?e:{}
this.hide()
var i=null
"warn"===this.type&&t.errorData&&0<t.errorData.length&&t.focusData?i={errorData:t.errorData,focusData:t.focusData}:"select"===this.type?i=t.selectData:"confirm"===this.type&&(i={isConfirm:t.isConfirm}),this.$emit("cancel",i)},getOrderList:function(e){var t=this,i=0<arguments.length&&void 0!==e?e:{}
this.orderCurPage=+i.page,this.selectStep=1,this.gettingOrder=!0,this.orderList=[],this.selectedOrder=null
var r=this.orderCurPage
s.get({url:"/cgi-bin/redpacketcover?action=get_order_list",data:{offset:(r-1)*this.orderPerPage,limit:this.orderPerPage}},function(e){!0===t.dialogShow&&1===t.selectStep&&t.orderCurPage===r&&(t.gettingOrder=!1,e&&e.base_resp?0==+e.base_resp.ret?(t.orderTotalNum=+e.total||0,e.order_list&&0<e.order_list.length&&(e.order_list.forEach(function(e){e.styleObj={"background-image":"url('"+e.receive_image+"')"},e.last_create_object_date_str=o.formatDate(1e3*e.last_create_object_date,"YYYY/MM/DD HH:mm"),0<=t.insertedOrderid.indexOf(e.order_id)?e.inserted=!0:e.inserted=!1}),t.orderList=e.order_list)):s.handleRet(e,{url:"/cgi-bin/redpacketcover?action=get_order_list",msg:"系统繁忙，请稍后再试"}):t.$tipsErr("系统繁忙，请稍后再试"))},function(){!0===t.dialogShow&&1===t.selectStep&&t.orderCurPage===r&&(t.gettingOrder=!1,t.$tipsErr("系统繁忙，请稍后再试"))})},getSubOrderList:function(e){var i=this,t=0<arguments.length&&void 0!==e?e:{}
this.subOrderCurPage=+t.page,this.selectStep=2,this.gettingSubOrder=!0,this.subOrderList=[],this.subOrderTimeStr=o.formatDate(new Date,"MM/DD HH:mm")
var r=this.selectedOrder.order_id
s.get({url:"/cgi-bin/redpacketcover?action=get_receive_object_list",data:{order_id:r,offset:(this.subOrderCurPage-1)*this.subOrderPerPage,limit:this.subOrderPerPage}},function(e){if(!0===i.dialogShow&&2===i.selectStep&&i.selectedOrder&&i.selectedOrder.order_id===r)if(i.gettingSubOrder=!1,e&&e.base_resp)if(0==+e.base_resp.ret){if(i.subOrderTotalNum=+e.total||0,e.receive_object_list&&0<e.receive_object_list.length){var t=i.selectedSubList.map(function(e){return e.receive_object_id})
e.receive_object_list.forEach(function(e){e.remain_count=e.total_gen_count-e.total_receive_count,e.expire_time_str=o.formatDate(1e3*e.expire_time,"YYYY/MM/DD HH:mm"),e.create_time_str=o.formatDate(1e3*e.create_time,"YYYY/MM/DD HH:mm"),e.checked=!!(0<=t.indexOf(e.receive_object_id))}),i.subOrderList=e.receive_object_list}}else s.handleRet(e,{url:"/cgi-bin/redpacketcover?action=get_receive_object_list",msg:"系统繁忙，请稍后再试"})
else i.$tipsErr("系统繁忙，请稍后再试")},function(){!0===i.dialogShow&&2===i.selectStep&&i.selectedOrder&&i.selectedOrder.order_id===r&&(i.gettingSubOrder=!1,i.$tipsErr("系统繁忙，请稍后再试"))})},selectedSubOrder:function(e){if(e.checked)this.selectedSubList.push(e)
else for(var t=0,i=this.selectedSubList.length;t<i;t++){if(this.selectedSubList[t].receive_object_id===e.receive_object_id){this.selectedSubList.splice(t,1)
break}}},preBtnClick:function(){this.selectedSubList=[],this.subOrderList=[],this.selectStep=1,this.selectedOrder=null},okBtnClick:function(){var t=this
if(!this.okBtnDisabled&&!this.okBtnLoading){this.okBtnLoading=!0
var e={list:this.selectedSubList.map(function(e){return e.receive_object_id})}
s.post({url:"/cgi-bin/redpacketcover?action=create_cover_uri",data:{receive_object_id_list:JSON.stringify(e)}},function(e){!0===t.dialogShow&&(t.okBtnLoading=!1,e&&e.base_resp?0==+e.base_resp.ret&&e.cover_uri?t.dialogClose({selectData:{cover_uri:e.cover_uri,name:t.selectedOrder.name,receive_image:t.selectedOrder.receive_image,order_id:t.selectedOrder.order_id}}):s.handleRet(e,{url:"/cgi-bin/redpacketcover?action=create_cover_uri",msg:"系统繁忙，请稍后再试"}):t.$tipsErr("系统繁忙，请稍后再试"))},function(){!0===t.dialogShow&&(t.okBtnLoading=!1,t.$tipsErr("系统繁忙，请稍后再试"))})}},confirmOkBtnClick:function(){"confirm"===this.type?this.dialogClose({isConfirm:!0}):"warn"===this.type&&this.focusRedPacketCover({focusData:this.item[0],errorData:this.item})},focusRedPacketCover:function(e){var t=0<arguments.length&&void 0!==e?e:{}
"opentab"===this.warnfocustype?this.openNewTab({errorData:t.errorData,focusData:t.focusData}):this.dialogClose({errorData:t.errorData,focusData:t.focusData})},openNewTab:function(e){var t=0<arguments.length&&void 0!==e?e:{}
if(wx&&wx.commonData&&wx.commonData.data&&wx.commonData.data.param){a.set({data:{cacheKey:d,cacheValue:{type:"redPacketCover",appmsgid:this.appmsgid,focusData:t.focusData,errorData:t.errorData},expireTime:+new Date+n}})
var i="/cgi-bin/appmsg?t=media/appmsg_edit&action=edit&type=10&appmsgid="+this.appmsgid+wx.commonData.data.param,r="appmsg_"+this.appmsgid,s=this.cacheWin[r]||null
!s||s.location&&s.location.href||(s=null,delete this.cacheWin[r]),s&&0<s.location.href.indexOf("/cgi-bin/appmsg?t=media/appmsg_edit&action=edit")&&0<s.location.href.indexOf("&appmsgid="+this.appmsgid)?window.open("",r):(s=window.open(i,r),this.cacheWin[r]=s),s&&"function"==typeof s.musicCheckResultFocus&&s.musicCheckResultFocus()}},selectOrder:function(e){this.selectedOrder=e,this.selectedSubList=[],this.getSubOrderList({page:1})},orderPageChange:function(e){var t=0<arguments.length&&void 0!==e?e:{}
this.getOrderList({page:t.currentPage})},subOrderPageChange:function(e){var t=0<arguments.length&&void 0!==e?e:{}
this.getSubOrderList({page:t.currentPage})}}})})
define("pages/modules/table/table.js",["vue-weui/src/radio/radio.js","vue-weui/src/checkbox/checkbox.js","pages/modules/table/table.css.js","pages/modules/table/table.tpl.js","pages/modules/utils/object.js"],function(t,e,a){"use strict"
t("vue-weui/src/radio/radio.js"),t("vue-weui/src/checkbox/checkbox.js"),t("pages/modules/table/table.css.js")
var s=t("pages/modules/table/table.tpl.js"),o=t("pages/modules/utils/object.js").assign
Vue.component("mp-table",{template:s,props:{data:{type:Object,default:{head:[],body:[],opt:{}}},extclass:{type:String,default:""},loading:{type:Boolean,default:!1}},data:function(){return{selallclass:"",trSelChecking:"",trSelAll:"",trSelCount:0}},mounted:function(){this.changeSelAllData()},computed:{headData:function(){return this.data.head?this.data.head:[]},bodyData:function(){for(var e=this,s=this.data.body?this.data.body:[],l=[],t=function(t){var a=o({},s[t])
a.__index=t,l.push(a),-1===["custom"].indexOf(a.type)&&(a.tds=e.headData.map(function(t){var e=a[t.key]
return"string"==typeof e&&(e={content:e}),e.key=t.key,e}))},a=0;a<s.length;a++)t(a)
return l},optData:function(){return this.data.opt?this.data.opt:{}},isEmpty:function(){return 0===this.bodyData.length},hasHeadSlot:function(){return this.$slots.head&&this.$slots.head.length},column:function(){var t=1
if(this.headData.length)t=this.headData.length
else if(this.bodyData.length)for(var e=0;e<this.bodyData.length;e++)if(this.bodyData[e].tds){t=this.bodyData[e].tds.length
break}return this.optData.editMode&&t++,t}},methods:{handleClickContent:function(t,e,a){var s={}
s.tr=t,s.row=e,s.column=a,console.log(s),this.$emit("click-content",s)},change:function(t){"multi"===this.optData.selMode&&this.changeSelAllData(),this.$emit("row-selected",{row:t,tr:this.bodyData[t]})},changeSelAllData:function(){if(this.optData.editMode){for(var t=0,e=0,a=0;a<this.bodyData.length;a++)this.bodyData[a].tds&&(t++,"checked"!==this.bodyData[a].checked&&!0!==this.bodyData[a].checked||e++)
0<e||"force"===this.optData.editMode?this.selallclass="weui-desktop-table_bat":this.selallclass="",this.trSelChecking=0<e&&t!==e?"checking":"",this.trSelAll=e===t,this.trSelCount=e}},changeAll:function(){if(!1===this.trSelAll){for(var t=0;t<this.bodyData.length;t++)this.bodyData[t].tds&&(this.bodyData[t].checked=!1)
this.$emit("row-unselect-all",!1)}else{for(var e=0;e<this.bodyData.length;e++)this.bodyData[e].tds&&(this.bodyData[e].checked=!0)
this.$emit("row-select-all",!0)}this.changeSelAllData()},unCheckAll:function(){this.trSelAll=!1,this.changeAll()}}})})
define("pages/modules/table/table.css.js", [], function (require, exports, module){module.exports = "@grid BreakPoints: {  xs: 0;  sm: 576px;  md: 768px;  lg: 992px;  xl: 1200px;}@container MaxWidths: {  xs: auto;  sm: 540px;  md: 720px;  lg: 960px;  xl: 1140px;}:root {  --weuiDesktop_themeColor: #07C160;  --weuiDesktop_errorColor: #FA5151;  --weuiDesktop_warningColor: #FFC300;  --weuiDesktop_neutralColor: #10AEFF;  --weuiDesktop_linkColor: #576B95;  --weuiDesktop_globalColor: #1A1B1C;  --weuiDesktop_focusColor: #4C4D4E;  --weuiDesktop_descColor: #7E8081;  --weuiDesktop_subColor: #B1B2B3;  --weuiDesktop_separateColor: #E3E4E5;  --weuiDesktop_globalBgColor: #F6F7F8;  --weuiDesktop_areaBgColor: #F6F7F8;  --weuiDesktop_cardBgColor: #FFFFFF;  --weuiDesktop_successColor: #07C160;  --weuiDesktop_maskColor_hover: rgba(0, 0, 0, 0.05);  --weuiDesktop_maskDeepColor_hover: rgba(0, 0, 0, 0.1);  --weuiDesktop_maskLightColor_hover: rgba(0, 0, 0, 0.02);  --weuiDesktop_maskMiddleColor_hover: rgba(0, 0, 0, 0.03);  --weuiDesktop_FG_Text_globalColor: var(--weuiDesktop_globalColor);  --weuiDesktop_FG_Text_globalColor_disabled: rgba(0, 0, 0, 0.2);  --weuiDesktop_FG_Text_descColor: var(--weuiDesktop_descColor);  --weuiDesktop_FG_Text_subColor: var(--weuiDesktop_subColor);  --weuiDesktop_FG_Text_lightColor: var(--weuiDesktop_cardBgColor);  --weuiDesktop_FG_Text_lightColor_disabled: rgba(255, 255, 255, 0.5);  --weuiDesktop_FG_Text_EmColor: var(--weuiDesktop_themeColor);  --weuiDesktop_FG_Text_errorColor: var(--weuiDesktop_errorColor);  --weuiDesktop_FG_Text_errorColor_disabled: rgba(250, 81, 81, 0.5);  --weuiDesktop_FG_Text_warningColor: var(--weuiDesktop_warningColor);  --weuiDesktop_FG_Text_linkColor: var(--weuiDesktop_linkColor);  --weuiDesktop_FG_Icon_descColor: var(--weuiDesktop_descColor);  --weuiDesktop_FG_Icon_subColor: var(--weuiDesktop_subColor);  --weuiDesktop_FG_Icon_lightColor: var(--weuiDesktop_cardBgColor);  --weuiDesktop_FG_Icon_emColor: var(--weuiDesktop_themeColor);  --weuiDesktop_FG_Icon_ErrorColor: var(--weuiDesktop_errorColor);  --weuiDesktop_FG_Icon_WarningColor: var(--weuiDesktop_warningColor);  --weuiDesktop_FG_Icon_linkColor: var(--weuiDesktop_linkColor);  --weuiDesktop_FG_Icon_infoColor: var(--weuiDesktop_neutralColor);  --weuiDesktop_BG_globalBgColor: var(--weuiDesktop_globalBgColor);  --weuiDesktop_BG_containerBgColor: var(--weuiDesktop_cardBgColor);  --weuiDesktop_BG_subBgColor: var(--weuiDesktop_areaBgColor);  --weuiDesktop_BG_emBgColor: var(--weuiDesktop_themeColor);  --weuiDesktop_BG_Selection_emBgColor: var(--weuiDesktop_BG_Selection_emBgColor);  --weuiDesktop_BG_ErrorBgColor: var(--weuiDesktop_errorColor);  --weuiDesktop_BG_WarningBgColor: var(--weuiDesktop_warningColor);  --weuiDesktop_BG_maskBgColor: rgba(0, 0, 0, 0.5);  --weuiDesktop_BG_lightMaskColor: rgba(255, 255, 255, 0.96);  --weuiDesktop_FG_Icon_infoBgColor: var(--weuiDesktop_neutralColor);  --weuiDesktop_lineColor: var(--weuiDesktop_separateColor);  --weuiDesktop_emlineColor: var(--weuiDesktop_globalColor);  --weuiDesktop_mediumFontWeight: 500;  --weuiDesktop_globalFontSize: 14px;  --weuiDesktop_H1FontSize: 24px;  --weuiDesktop_H2FontSize: 20px;  --weuiDesktop_H3FontSize: 16px;  --weuiDesktop_contentFontSize: 17px;  --weuiDesktop_descFontSize: 12px;  --weuiDesktop_globalLineHeight: 1.6;  --weuiDesktop_articleLineHeight: 1.6;  --weuiDesktop_lowShadow: 0px 1px 4px rgba(0, 0, 0, 0.2);  --weuiDesktop_highShadow: 0px 2px 8px rgba(0, 0, 0, 0.13);  --weuiDesktop_largeGapLayout: 1352px;  --weuiDesktop_mediumGapLayout: 1560px;  --weuiDesktop_globalBorderRadius: 4px;  --weuiDesktop_minBorderRadius: 2px;  --weuiDesktop_cardBorderRadius: 8px;  --weuiDesktop_menuWidth: 288px;  --weuiDesktopBtnPrimaryColor: #FFFFFF;  --weuiDesktopBtnPrimaryBackgroundColorHL: #F25C42;  --weuiDesktopBtnPrimaryBorderColorHL: #F25C42;  --weuiDesktopBtnPrimaryColorHL: rgba(255, 255, 255, 0.8);  --weuiDesktopBtnDefaultBackgroundColor: rgba(0, 0, 0, 0.03);  --weuiDesktopBtnDefaultBorderColor: #E4E8EB;  --weuiDesktopBtnDefaultColor: #FF6146;  --weuiDesktopBtnDefaultBackgroundColorHL: #EAEAEA;  --weuiDesktopBtnDefaultBorderColorHL: #EAEAEA;  --weuiDesktopBtnDefaultColorHL: #F25C42;  --weuiDesktopTitleTabBorderColor: #E0E1E2;  --weuiDesktopTitleTabHoverBorderColor: #a0a3ab;  --weuiDesktopSectionTabBorderColor: #C9CACE;  --weuiDesktopSectionTabCurrentBackgroundColor: #07C160;  --weuiDesktopSectionTabCurrentBorderColor: #07C160;  --weuiDesktopSectionTabCurrentColor: #FFFFFF;  --slider-color: #07C160;  --weuiDesktopTableBorderColor: #E3E4E5;  --weuiDesktopTableHeadColor: #7E8081;  --weuiDesktopTableHeadBackgroundColor: #F6F7F8;}/*How to usefont-family: 'wechatnum';*/.weui-desktop-table {  width: 100%;  border-collapse: collapse;  text-align: left;  /*tr{      &:first-child{        th{          &:first-child{            padding-left: @weuiDesktopTableCellPaddingX;            text-align: left;          }        }      }    } */}.weui-desktop-table th,.weui-desktop-table td {  padding: 18.8px 10px;  word-break: break-all;}.weui-desktop-table th:last-child,.weui-desktop-table td:last-child {  padding-right: 20px;  text-align: right;}.weui-desktop-table th:last-child .weui-desktop-link,.weui-desktop-table td:last-child .weui-desktop-link {  display: inline-block;  vertical-align: middle;  margin-right: 0;  margin-left: 14px;}.weui-desktop-table th:last-child .weui-desktop-link:first-child,.weui-desktop-table td:last-child .weui-desktop-link:first-child {  margin-left: 0;}.weui-desktop-table th:first-child,.weui-desktop-table td:first-child {  padding-left: 20px;  text-align: left;}.weui-desktop-table th {  font-weight: 400;}.weui-desktop-table th.weui-desktop-th__dropdown__wrp {  padding: 0;}.weui-desktop-table td {  border-bottom: 1px solid #E3E4E5;  border-bottom: 1px solid var(--weuiDesktopTableBorderColor);}.weui-desktop-table td:first-child {  padding-left: 20px;  text-align: left;}.weui-desktop-table td[loading=\"true\"],.weui-desktop-table td[empty=\"true\"] {  color: var(--weuiDesktop_FG_Text_subColor);  text-align: center;  padding: 65px 0;}.weui-desktop-table__hd {  background-color: #F6F7F8;  background-color: var(--weuiDesktopTableHeadBackgroundColor);  color: #7E8081;  color: var(--weuiDesktopTableHeadColor);}.weui-desktop-table__opr {  padding-bottom: 20px;  border-bottom: 1px solid #E3E4E5;  border-bottom: 1px solid var(--weuiDesktopTableBorderColor);}th.weui-desktop-table_rank,td.weui-desktop-table_rank {  text-align: right;}td.weui-desktop-table_rank {  padding-right: 24px;}th.weui-desktop-table_rank {  position: relative;  cursor: pointer;  padding-right: 20px;}th.weui-desktop-table_rank:before,th.weui-desktop-table_rank:after {  content: \" \";  position: absolute;  right: 10px;  top: 50%;}th.weui-desktop-table_rank:before {  display: inline-block;  width: 0;  height: 0;  border-width: 4px;  border-style: dashed;  border-color: transparent;  border-top-width: 0;  border-bottom-color: #D7D7D7;  border-bottom-style: solid;  margin-top: -6px;}th.weui-desktop-table_rank:after {  display: inline-block;  width: 0;  height: 0;  border-width: 4px;  border-style: dashed;  border-color: transparent;  border-bottom-width: 0;  border-top-color: #D7D7D7;  border-top-style: solid;  margin-bottom: -6px;}th.weui-desktop-table_rank:hover:before {  border-bottom-color: #BBBBBB;}th.weui-desktop-table_rank:hover:after {  border-top-color: #BBBBBB;}th.weui-desktop-table_rank_up:after {  display: none;}th.weui-desktop-table_rank_down:before {  display: none;}.weui-desktop-table_dropdown {  position: relative;}.weui-desktop-table_dropdown .weui-desktop-form__drop-down-label {  position: absolute;  top: 0;  background-color: transparent;  border-width: 0;  line-height: 57px;}.weui-desktop-table_dropdown .weui-desktop-form__drop-down__dd {  line-height: 2.57142857;}.weui-desktop-table__row_current.weui-desktop-table__row_current > td {  padding: 0;}.weui-desktop-table__row_current td {  border-bottom-width: 0;}.weui-desktop-table__fold-table {  background: #FFFFFF;  box-shadow: 0 1px 20px 0 rgba(0, 0, 0, 0.1);  border-radius: var(--weuiDesktop_cardBorderRadius);}.weui-desktop-table__fold-context {  position: relative;}.weui-desktop-table__fold-context:before {  content: \" \";  border-top: 1px solid #E3E4E5;  border-top: 1px solid var(--weuiDesktopTableBorderColor);  position: absolute;  top: -18.8px;  left: 0;  right: 0;}.weui-desktop-table_bat th:first-child .weui-desktop-form__check-label,.weui-desktop-table_bat td:first-child .weui-desktop-form__check-label {  visibility: visible;  opacity: 1;}.weui-desktop-table__check-cell {  text-align: left;}.weui-desktop-table__check-cell .weui-desktop-form__check-label {  visibility: hidden;  opacity: 0;  margin-top: -4px;  -webkit-transition: opacity .34s;  transition: opacity .34s;}tr:hover .weui-desktop-table__check-cell .weui-desktop-form__check-label {  visibility: visible;  opacity: 1;}.weui-desktop-table__check-cell.weui-desktop-table__check-cell {  padding-left: 10px;  padding-right: 5px;  width: 1px;}.weui-desktop-table__check-cell + th,.weui-desktop-table__check-cell + td {  padding-left: 0;}.weui-desktop-table__row_checked {  background-color: #F4FBF4;}.weui-desktop-table__row_bat {  background-color: var(--weuiDesktop_BG_globalBgColor);}.weui-desktop-table__row_bat td {  border-bottom-width: 0;  padding-left: 36px;}.weui-desktop-table__bat-context {  position: relative;  padding-left: 18px;}.weui-desktop-table__bat-context:before {  border-top: 1px solid #E3E4E5;  content: \" \";  border-top: 1px solid var(--weuiDesktopTableBorderColor);  position: absolute;  top: -18.8px;  left: 18px;  right: 0;}.weui-desktop-table_th-split-default th {  border-bottom: 1px solid #E3E4E5;  border-bottom: 1px solid var(--weuiDesktopTableBorderColor);  border-right: 1px solid #E3E4E5;  border-right: 1px solid var(--weuiDesktopTableBorderColor);  padding: 10px;}.weui-desktop-table_th-split-default th:last-child {  border-right-width: 0;}.weui-desktop-table_odd_col_primary td:nth-child(odd) {  background-color: #F4FBF4;}.weui-desktop-table_even_col_primary td:nth-child(even) {  background-color: #F4FBF4;}.weui-desktop-table__title {  padding-bottom: 10px;  font-weight: 400;  font-size: var(--weuiDesktop_globalFontSize);}.weui-desktop-table_show-head .weui-desktop-table__bd {  display: none;}.weui-desktop-table_show-body .weui-desktop-table__hd {  display: none;}";});define("pages/modules/table/table.tpl.js",[],function(t,e,l){return'<div :class="[\'weui-desktop-table__wrp\', extclass, selallclass]">  <table class="weui-desktop-table">    <thead v-if="hasHeadSlot" class="weui-desktop-table__hd">      <slot name="head"></slot>    </thead>    <thead v-else class="weui-desktop-table__hd">      <tr>        <th class="weui-desktop-table__check-cell" v-if="!!optData.editMode">          <mp-checkbox v-if="optData.selMode === \'multi\'" v-model="trSelAll" :checking="trSelChecking" @change="changeAll()"></mp-checkbox>        </th>        <th v-for="th in headData" :class="th.className">          {{th.title}}        </th>      </tr>    </thead>    <tbody class="weui-desktop-table__bd">      <template v-if="loading">        <tr>          <td :colspan="column" loading="true">            <i class="weui-desktop-loading">加载中</i>          </td>        </tr>      </template>      <template v-else-if="isEmpty">        <tr>          <td :colspan="column" empty="true">            <template v-if="$slots.empty && $slots.empty.length > 0"><slot name="empty"></slot></template>            <template v-else>暂无数据</template>          </td>        </tr>      </template>      <template v-else>        <transition name="fade">          <tr v-if="trSelCount > 0" class="weui-desktop-table__row_bat">            <td :colspan="column-1">              已选择{{trSelCount}}项内容 <a href="javascript:;" @click="unCheckAll()">取消选择</a>            </td>            <td>              <slot name="operationAll"></slot>            </td>          </tr>        </transition>        <tr v-for="(tr, i) in bodyData" :class="[tr.className, tr.checked==true?\'weui-desktop-table__row_checked\':\'\', tr.unfold==true?\'weui-desktop-table__row_current\':\'\']">          <template v-if="tr.unfold">                        <td :colspan="column">              <table class="weui-desktop-table weui-desktop-table__fold-table">                <tr>                  <td class="weui-desktop-table__check-cell" v-if="!!optData.editMode">                    <mp-checkbox v-if="optData.selMode === \'multi\'" v-model="tr.checked" @change="change(i)"></mp-checkbox>                    <mp-radio name="--tbl-radio" v-if="optData.selMode === \'single\'" v-model="tr.checked" @change="change(i)" />                  </td>                  <td v-for="(td, j) in tr.tds" :class="td.className">                    <template v-if="td.type === \'custom\'">                      <slot :name="td.slot || \'customCell\'" :row="tr.__index" :column="td.key" :td="td"></slot>                    </template>                    <template v-else>                      <template v-if="td.isHTML"><span v-html="td.content"></span></template>                      <template v-else>{{td.content}}</template>                    </template>                  </td>                </tr>                <tr class="weui-desktop-table__fold-row">                  <td :colspan="column">                    <div class="weui-desktop-table__fold-context">                      <slot name="customRow" :row="i"></slot>                    </div>                  </td>                </tr>              </table>            </td>          </template>          <template v-else>            <td class="weui-desktop-table__check-cell" v-if="!!optData.editMode">              <mp-checkbox v-if="optData.selMode === \'multi\'" v-model="tr.checked" @change="change(i)"></mp-checkbox>              <mp-radio name="--tbl-radio" v-if="optData.selMode === \'single\'" v-model="tr.checked" @change="change(i)" />            </td>            <td v-for="(td, j) in tr.tds" :class="td.className" @click="handleClickContent(tr, i, j)">              <template v-if="td.type === \'custom\'">                <slot :name="td.slot || \'customCell\'" :row="tr.__index" :column="td.key" :td="td"></slot>              </template>              <template v-else>                <template v-if="td.isHTML"><span v-html="td.content"></span></template>                <template v-else>{{td.content}}</template>              </template>            </td>          </template>        </tr>                <tr style="display:none">          <td>x</td>          <td>x</td>          <td>x</td>        </tr>                <tr style="display:none" class="weui-desktop-table__row_current">          <td colspan="3">            <table class="weui-desktop-table weui-desktop-table__fold-table">              >              <tr>                <td>x</td>                <td>x</td>                <td>x</td>              </tr>                            <tr class="weui-desktop-table__fold-row">                <td colspan="3">                  <div class="weui-desktop-table__fold-context">展开内容</div>                </td>              </tr>            </table>          </td>        </tr>      </template>    </tbody>  </table></div>'})
