---
title: "容器云平台系列 - 配额管理"
date: 2022-05-16T15:49:45+08:00
lastmod: 2022-05-16T15:49:45+08:00
draft: true
keywords: ["quota", "kubernetes"]
description: ""
tags: ["思考"]
categories: ["思考感悟"]
author: "Kaku Li" 
---

## 为什么需要配额管理？

Kubernetes 作为容器编排系统的事实标准已经被广泛使用，但在使用过程中或多或少会存在如下问题：

1. 当集群中出现超过集群容量的工作负载会出现什么问题？又应该如何解决？
2. 当多个用户或团队共享具有固定节点数目的集群时，人们会担心有其他人使用超过其所分配到的资源量。

在资源无限的情况下，上述问题是不存在的，但现实情况相反，机器资源是成本的重要部分



## 什么是配额？





配额（Quota）用来决定准许哪个作业可以被调度。配额是**特定优先级**和**时间段**（典型是几个月）的一个资源向量（CPU，内存，硬盘等）。配额限制了用户的作业一次可以申请资源的最大数量（如：20TB 内存，prod 优先级，从年初到年底）。

配额检查是准入控制的一部分，而不是调度的：配额不足的作业提交时当即就会被拒绝。

## 配额怎么设计？

肯定还是要贴合实际业务场景来设计，但 kubernetes 丰富的能力已经被各厂玩出了花，只有想不到，没有做不到。所以并没有哪一个方案是最好的，只有最适合的。

不能解决实际业务问题的方案犹如空中楼阁，但方案设计又不能仅限于满足业务需求，这样就会处于为了满足业务需求而疲于应付需求的状态，理想状态是**源于业务，但高于业务，先于业务**。



